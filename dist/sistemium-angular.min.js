"use strict";!function(e){e.module("sistemium.config",[]).value("sistemium.config",{debug:!0}),e.module("sistemium.directives",[]),e.module("sistemium.filters",[]),e.module("sistemium.services",[]),e.module("sistemium.models",[]),e.module("sistemium.dependencies",["toastr","js-data","ui.router.stateHelper"]),e.module("sistemium",["sistemium.dependencies","sistemium.config","sistemium.directives","sistemium.filters","sistemium.services","sistemium.models"])}(angular),function(){angular.module("sistemium.models").config(["DSProvider",function(e){angular.extend(e.defaults,{beforeInject:function(e,n){n.id||(n.id=uuid.v4())},beforeCreate:function(e,n,t){n.id||(n.id=uuid.v4()),t(null,n)}})}]).config(["DSHttpAdapterProvider",function(e){angular.extend(e.defaults,{httpConfig:{headers:{"X-Return-Post":"true",authorization:window.localStorage.getItem("authorization"),"X-Page-Size":1e3}},queryTransform:function(e,n){var t={};return n.offset&&(t["x-start-page:"]=Math.ceil(n.offset/n.limit)),n.limit&&(t["x-page-size:"]=n.limit),delete n.limit,delete n.offset,angular.extend(t,n)}})}])}(),function(){function e(e){angular.extend(e,{allowHtml:!0,timeOut:3e3,positionClass:"toast-top-right",preventDuplicates:!1,progressBar:!1,iconClasses:{error:"alert alert-danger",info:"alert alert-info",success:"alert alert-success",warning:"alert alert-warning"}})}angular.module("sistemium.dependencies").config(["toastrConfig",e])}(),function(){function e(e,n){function t(t,r,a){var i=a.changeClass;t.$watch(a.saAnimateOnChange,function(t,a){(t||0)!==(a||0)&&e.addClass(r,i).then(function(){n(function(){e.removeClass(r,i)})})})}return{restrict:"A",replace:!0,link:t}}angular.module("sistemium.directives").directive("saAnimateOnChange",["$animate","$timeout",e])}(),function(){angular.module("sistemium.directives").directive("saTypeaheadClickOpen",["$timeout",function(e){return{require:"ngModel",link:function(n,t){var r=function(){var n=t.controller("ngModel"),r=n.$modelValue||"";r?(n.$setViewValue(""),e(function(){n.$setViewValue(r)})):n.$setViewValue(" ")};t.bind("click",r)}}}])}(),function(){function e(e,n){function t(e,t,a,i,o){var s=_.chunk(t,e),u=_.map(s,function(e){return function(r){var s=n.all(_.map(e,function(e){return a(e)}));return s.then(function(e){angular.isFunction(i)&&i(e,t.length),r(null,e)}),s.catch(function(n){angular.isFunction(o)&&o(e),r(n,e)})}});return n(function(e,n){r.series(u,function(r,a){r?n(r):e(t,a)})})}var r=e.async;return angular.extend(r,{chunkSerial:t})}angular.module("sistemium.services").service("saAsync",["$window","$q",e])}(),function(){function e(){function e(e){return window.debug(e)}return{log:e}}angular.module("sistemium.services").service("saDebug",e)}(),function(){angular.module("sistemium.services").factory("saFormlyConfigService",function(){function e(e){if(a.hasOwnProperty(e))return a[e];throw new Error("No such key "+e+" in formlyConfig...")}function n(e,n){a[e]=n}function t(){return a}function r(e,n){return _.find(e,function(e){return e.key===n})}var a={};return{getConfigFieldsByKey:e,setConfig:n,getAll:t,getConfigKey:r}})}(),function(){angular.module("sistemium.services").factory("saHttpStatusService",function(){return{getStatusCodeText:function(e){var n="";switch(parseInt(e.toString(),10)){case 100:n="Continue";break;case 101:n="Switching Protocols";break;case 102:n="Processing (WebDAV; RFC 2518)";break;case 200:n="OK";break;case 201:n="Created";break;case 202:n="Accepted";break;case 203:n="Non-Authoritative Information (since HTTP/1.1)";break;case 204:n="No Content";break;case 205:n="Reset Content";break;case 206:n="Partial Content";break;case 207:n="Multi-Status (WebDAV; RFC 4918)";break;case 208:n="Already Reported (WebDAV; RFC 5842)";break;case 226:n="IM Used (RFC 3229)";break;case 300:n="Multiple Choices";break;case 301:n="Moved Permanently";break;case 302:n="Found";break;case 303:n="See Other";break;case 304:n="Not Modified";break;case 305:n="Use Proxy";break;case 306:n="Switch Proxy";break;case 307:n="Temporary Redirect";break;case 308:n="Permanent Redirect (Experimental RFC; RFC 7238)";break;case 400:n="Bad Request";break;case 401:n="Unauthorized";break;case 402:n="Payment Required";break;case 403:n="Forbidden";break;case 404:n="Not Found";break;case 405:n="Method Not Allowed";break;case 406:n="Not Acceptable";break;case 407:n="Proxy Authentication Required";break;case 408:n="Request Timeout";break;case 409:n="Conflict";break;case 410:n="Gone";break;case 411:n="Length Required";break;case 412:n="Precondition Failed";break;case 413:n="Request Entity Too Large";break;case 414:n="Request-URI Too Long";break;case 415:n="Unsupported Media Type";break;case 416:n="Requested Range Not Satisfiable";break;case 417:n="Expectation Failed";break;case 418:n="I'm a teapot (RFC 2324)";break;case 419:n="Authentication Timeout (not in RFC 2616)";break;case 420:n="Method Failure (Spring Framework) / Enhance Your Calm (Twitter)";break;case 422:n="Unprocessable Entity (WebDAV; RFC 4918)";break;case 423:n="Locked (WebDAV; RFC 4918)";break;case 424:n="Failed Dependency (WebDAV; RFC 4918)";break;case 426:n="Upgrade Required";break;case 428:n="Precondition Required (RFC 6585)";break;case 429:n="Too Many Requests (RFC 6585)";break;case 431:n="Request Header Fields Too Large (RFC 6585)";break;case 440:n="Login Timeout (Microsoft)";break;case 444:n="No Response (Nginx)";break;case 449:n="Retry With (Microsoft)";break;case 450:n="Blocked by Windows Parental Controls (Microsoft)";break;case 451:n="Unavailable For Legal Reasons (Internet draft) / Redirect (Microsoft)";break;case 494:n="Request Header Too Large (Nginx)";break;case 495:n="Cert Error (Nginx)";break;case 496:n="No Cert (Nginx)";break;case 497:n="HTTP to HTTPS (Nginx)";break;case 498:n="Token expired/invalid (Esri)";break;case 499:n="Client Closed Request (Nginx) / Token required (Esri)";break;case 500:n="Internal Server Error";break;case 501:n="Not Implemented";break;case 502:n="Bad Gateway";break;case 503:n="Service Unavailable";break;case 504:n="Gateway Timeout";break;case 505:n="HTTP Version Not Supported";break;case 506:n="Variant Also Negotiates (RFC 2295)";break;case 507:n="Insufficient Storage (WebDAV; RFC 4918)";break;case 508:n="Loop Detected (WebDAV; RFC 5842)";break;case 509:n="Bandwidth Limit Exceeded (Apache bw/limited extension)";break;case 510:n="Not Extended (RFC 2774)";break;case 511:n="Network Authentication Required (RFC 6585)";break;case 520:n="Origin Error (Cloudflare)";break;case 521:n="Web server is down (Cloudflare)";break;case 522:n="Connection timed out (Cloudflare)";break;case 523:n="Proxy Declined Request (Cloudflare)";break;case 524:n="A timeout occurred (Cloudflare)";break;case 598:n="Network read timeout error (Unknown)";break;case 599:n="Network connect timeout error (Unknown)";break;default:n="Unknown HTTP status '"+e+"', what is this?"}return n}}})}(),function(){angular.module("sistemium.services").factory("saMessageService",["toastr",function(e){function n(n,t,r,a,i){t=t||"",r=r||{},e[i](n,t,_.assign(a,r))}var t={};return t.success=function(e,t,r){var a={timeOut:2e3};n(e,t,r,a,"success")},t.info=function(e,t,r){var a={timeout:3e3};n(e,t,r,a,"info")},t.warning=function(e,t,r){var a={timeout:3e3};n(e,t,r,a,"warning")},t.error=function(e,t,r){var a={timeout:4e3};n(e,t,r,a,"error")},t}])}(),angular.module("sistemium.services").service("saSchema",function(e,n,t){var r=6,a=function(e){return{sumFn:function(n){return _.reduce(n,function(n,t){return n+(_.result(t,e)||0)},0)},sum:function(n){return _.reduce(n,function(n,t){return n+(_.get(t,e)||0)},0)},custom:function(n,t,r){return _.reduce(n,function(n,r){return t(n,_.result(r,e))},r)}}},i=function(e,n){return function(t,r){var i={};return _.each(e,function(e){var o=e.name||e,s=e.type||n;i[o]=function(){return a(o)[s](t[r])}}),i}};return function(o){var s={};return{register:function(a){function u(e){return function(n,t){return{name:angular.isString(n)?n:t,type:e}}}var c=s[a.name]=e.defineResource(a),l=_.map(a.methods,u("sumFn"));return Array.prototype.push.apply(l,_.map(a.aggregables,u("sum"))),c.agg=i(l),_.each(o,function(e,n){c[n]=angular.isFunction(e)?function(){return e.apply(this,arguments)}:e}),c.findAllWithRelations=function(e,a){return function(i,o,s,u){return n(function(n,l){c.findAll(e,a).then(function(e){function a(e){return t.chunkSerial(r,e,function(e){return c.loadRelations(e,i,u)},o||_.noop,s||_.noop).then(n,l)}return a(e).then(n,l)}).catch(l)})}},c},models:function(){return s},model:function(e){return s[e]},aggregate:a}}}),angular.module("sistemium.services").service("saSockets",["$rootScope","$q",function(e,n){function t(e){c.io.uri=e.url.socket,c.open(),u=e.jsDataPrefix||""}function r(n,t){var r=function(){var n=arguments;e.$apply(function(){t.apply(c,n)})};return c.on(n,r),function(){c.removeListener(n,r)}}function a(n,t,r){if(angular.isFunction(t)&&!r){if(!c.connected)return t.apply(c,[{error:"Нет подключения к серверу"}]);c.emit(n,function(){var n=arguments;e.$apply(function(){t&&t.apply(c,n)})})}else c.emit(n,t,function(){var n=arguments;e.$apply(function(){r&&r.apply(c,n)})})}function i(e,t){var r=n.defer();return a(e,t,function(e){e?e.data?r.resolve(e.data):e.error&&r.reject(e):r.resolve()}),r.promise}function o(e,n){return r(e,function(e){angular.isString(e.resource)&&(e.resource=e.resource.replace(u,"")),n(e)})}function s(e){var n={id:!0,originalFilter:e,filter:_.map(e,function(e){return u+e})};return l.push(n),i("jsData:subscribe",n.filter).then(function(e){n.id=e}),function(){n.id&&(a("jsData:unsubscribe",n.id),l.splice(l.indexOf(n),1))}}var u,c=window.io({autoConnect:!1,path:"/socket.io-client"}),l=[];return e.$on("$destroy",e.$on("socket:authorized",function(){_.each(l,function(e){e.id&&i("jsData:subscribe",e.filter).then(function(n){e.id=n})})})),{io:c,init:t,emit:a,emitQ:i,on:r,jsDataSubscribe:s,onJsData:o,removeAllListeners:function(){c.removeAllListeners()},removeListener:function(e,n){c.removeListener(e,n)}}}]);